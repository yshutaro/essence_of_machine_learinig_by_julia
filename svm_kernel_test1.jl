include("svm.jl")

using .svm
using Plots
using Random

Random.seed!(0)
X0 = randn(100, 2)
#X0 = [1.76405235  0.40015721;
# 0.97873798  2.2408932 ;
# 1.86755799 -0.97727788;
# 0.95008842 -0.15135721;
#-0.10321885  0.4105985 ;
# 0.14404357  1.45427351;
# 0.76103773  0.12167502;
# 0.44386323  0.33367433;
# 1.49407907 -0.20515826;
# 0.3130677  -0.85409574;
#-2.55298982  0.6536186 ;
# 0.8644362  -0.74216502;
# 2.26975462 -1.45436567;
# 0.04575852 -0.18718385;
# 1.53277921  1.46935877;
# 0.15494743  0.37816252;
#-0.88778575 -1.98079647;
#-0.34791215  0.15634897;
# 1.23029068  1.20237985;
#-0.38732682 -0.30230275;
#-1.04855297 -1.42001794;
#-1.70627019  1.9507754 ;
#-0.50965218 -0.4380743 ;
#-1.25279536  0.77749036;
#-1.61389785 -0.21274028;
#-0.89546656  0.3869025 ;
#-0.51080514 -1.18063218;
#-0.02818223  0.42833187;
# 0.06651722  0.3024719 ;
#-0.63432209 -0.36274117;
#-0.67246045 -0.35955316;
#-0.81314628 -1.7262826 ;
# 0.17742614 -0.40178094;
#-1.63019835  0.46278226;
#-0.90729836  0.0519454 ;
# 0.72909056  0.12898291;
# 1.13940068 -1.23482582;
# 0.40234164 -0.68481009;
#-0.87079715 -0.57884966;
#-0.31155253  0.05616534;
#-1.16514984  0.90082649;
# 0.46566244 -1.53624369;
# 1.48825219  1.89588918;
# 1.17877957 -0.17992484;
#-1.07075262  1.05445173;
#-0.40317695  1.22244507;
# 0.20827498  0.97663904;
# 0.3563664   0.70657317;
# 0.01050002  1.78587049;
# 0.12691209  0.40198936;
# 1.8831507  -1.34775906;
#-1.270485    0.96939671;
#-1.17312341  1.94362119;
#-0.41361898 -0.74745481;
# 1.92294203  1.48051479;
# 1.86755896  0.90604466;
#-0.86122569  1.91006495;
#-0.26800337  0.8024564 ;
# 0.94725197 -0.15501009;
# 0.61407937  0.92220667;
# 0.37642553 -1.09940079;
# 0.29823817  1.3263859 ;
#-0.69456786 -0.14963454;
#-0.43515355  1.84926373;
# 0.67229476  0.40746184;
#-0.76991607  0.53924919;
#-0.67433266  0.03183056;
#-0.63584608  0.67643329;
# 0.57659082 -0.20829876;
# 0.39600671 -1.09306151;
#-1.49125759  0.4393917 ;
# 0.1666735   0.63503144;
# 2.38314477  0.94447949;
#-0.91282223  1.11701629;
#-1.31590741 -0.4615846 ;
#-0.06824161  1.71334272;
#-0.74475482 -0.82643854;
#-0.09845252 -0.66347829;
# 1.12663592 -1.07993151;
#-1.14746865 -0.43782004;
#-0.49803245  1.92953205;
# 0.94942081  0.08755124;
#-1.22543552  0.84436298;
#-1.00021535 -1.5447711 ;
# 1.18802979  0.31694261;
# 0.92085882  0.31872765;
# 0.85683061 -0.65102559;
#-1.03424284  0.68159452;
#-0.80340966 -0.68954978;
#-0.4555325   0.01747916;
#-0.35399391 -1.37495129;
#-0.6436184  -2.22340315;
# 0.62523145 -1.60205766;
#-1.10438334  0.05216508;
#-0.739563    1.5430146 ;
#-1.29285691  0.26705087;
#-0.03928282 -1.1680935 ;
# 0.52327666 -0.17154633;
# 0.77179055  0.82350415;
# 2.16323595  1.33652795]

X1 = randn(100, 2) .+ [2.5 3]
#X1 =[ 2.13081816  2.76062082;
# 3.5996596   3.65526373;
# 3.14013153  1.38304396;
# 2.47567388  2.26196909;
# 2.7799246   2.90184961;
# 3.41017891  3.31721822;
# 3.28632796  2.5335809 ;
# 1.55555374  2.58995031;
# 2.48297959  3.37915174;
# 4.75930895  2.95774285;
# 1.544055    2.65401822;
# 2.03640403  3.48148147;
# 0.95920299  3.06326199;
# 2.65650654  3.23218104;
# 1.90268393  2.76207827;
# 1.07593909  2.50668012;
# 1.95713852  3.41605005;
# 1.34381757  3.7811981 ;
# 3.99448454  0.93001497;
# 2.92625873  3.67690804;
# 1.86256297  2.60272819;
# 2.36711942  2.70220912;
# 2.19098703  1.32399619;
# 3.65233156  4.07961859;
# 1.68663574  1.53357567;
# 3.02106488  2.42421203;
# 2.64195316  2.68067158;
# 3.19153875  3.69474914;
# 1.77440262  1.61663604;
# 0.9170616   3.61037938;
# 1.31114074  2.49318365;
# 1.90368596  2.9474327 ;
# 0.56372019  3.1887786 ;
# 3.02389102  3.08842209;
# 2.18911383  3.09740017;
# 2.89904635  0.22740724;
# 4.45591231  3.39009332;
# 1.84759142  2.60904662;
# 2.99374178  2.88389606;
# 0.46931553  5.06449286;
# 2.38945934  4.02017271;
# 1.80795015  4.53637705;
# 2.78634369  3.60884383;
# 1.45474663  4.21114529;
# 3.18981816  4.30184623;
# 1.87191244  2.51897288;
# 4.8039167   1.93998418;
# 2.3640503   4.13689136;
# 2.59772497  3.58295368;
# 2.10055097  3.37005589;
# 1.19347315  4.65813068;
# 2.38183595  2.3198218 ;
# 3.16638308  2.53928021;
# 1.16574153  1.65328249;
# 3.19377315  2.84042656;
# 2.36629844  4.07774381;
# 1.37317419  2.26932225;
# 2.11512019  3.09435159;
# 2.45782855  2.71311281;
# 2.4383736   2.89269472;
# 1.78039561  2.18700701;
# 2.77451636  2.10908492;
# 1.34264474  2.68770775;
# 2.34233298  5.2567235 ;
# 1.79529972  3.94326072;
# 3.24718833  1.81105504;
# 3.27325298  1.81611936;
#-0.15917224  3.60631952;
# 0.74410942  3.45093446;
# 1.8159891   4.6595508 ;
# 3.5685094   2.5466142 ;
# 1.81216239  1.7859226 ;
# 2.05907737  2.7196445 ;
# 2.13530646  3.15670386;
# 3.0785215   3.34965446;
# 1.73585608  1.56220853;
# 3.86453185  2.31055082;
# 1.8477064   2.47881069;
# 0.65693045  2.522026  ;
# 2.02034419  3.6203583 ;
# 3.19845715  3.00377089;
# 3.43184837  3.33996498;
# 2.48431789  3.16092817;
# 2.30934651  2.60515049;
# 2.23226646  1.87198867;
# 2.78044171  2.00687639;
# 3.34163126  2.75054142;
# 2.54949498  3.49383678;
# 3.14331447  1.42937659;
# 2.29309632  3.88017891;
# 0.80189418  3.38728048;
# 0.24443577  1.97749316;
# 2.53863055  1.3432849 ;
# 1.51448926  1.52816499;
# 4.14813493  3.16422776;
# 3.06729028  2.7773249 ;
# 2.14656825  1.38352581;
# 2.20816264  2.23850779;
# 3.35792392  4.14110187;
# 3.96657872  3.85255194]

y = vcat([1 for x in 1:100], [-1 for x in 1:100])

X = vcat(X0, X1)

model = svm.SVC()
svm.fit(model, X, y)

xmin = minimum(X[:,1])
xmax = maximum(X[:,1])
ymin = minimum(X[:,2])
ymax = maximum(X[:,2])

x_range = LinRange(xmin, xmax, 200)
y_range = LinRange(ymin, ymax, 200)
xmesh = repeat(x_range', outer=(length(y_range),1))
ymesh = repeat(y_range,  outer=(1,length(x_range)))

Z = reshape(svm.predict(model, hcat(vec(xmesh), vec(ymesh))), size(xmesh))

print("正しく分類できた数:", sum(svm.predict(model, X) .== y))

scatter(X0[:, 1], X0[:, 2], color="black", markershape=:star6, label="")
scatter!(X1[:, 1], X1[:, 2], color="black", markershape=:+, label="")
contour!(x_range, y_range, Z, levels=[0], color=:black)
